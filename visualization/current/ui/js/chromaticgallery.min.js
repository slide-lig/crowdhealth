var linearPartition,_this=this;linearPartition=function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d;o=e.length;if(t<=0){return[]}if(t>o){return e.map(function(e){return[e]})}a=function(){var e,n;n=[];for(l=e=0;0<=o?e<o:e>o;l=0<=o?++e:--e){n.push(function(){var e,n;n=[];for(f=e=0;0<=t?e<t:e>t;f=0<=t?++e:--e){n.push(0)}return n}())}return n}();u=function(){var e,n,r;r=[];for(l=e=0,n=o-1;0<=n?e<n:e>n;l=0<=n?++e:--e){r.push(function(){var e,n,r;r=[];for(f=e=0,n=t-1;0<=n?e<n:e>n;f=0<=n?++e:--e){r.push(0)}return r}())}return r}();for(r=c=0;0<=o?c<o:c>o;r=0<=o?++c:--c){a[r][0]=e[r]+(r?a[r-1][0]:0)}for(i=h=0;0<=t?h<t:h>t;i=0<=t?++h:--h){a[0][i]=e[0]}for(r=p=1;1<=o?p<o:p>o;r=1<=o?++p:--p){for(i=d=1;1<=t?d<t:d>t;i=1<=t?++d:--d){s=_.min(function(){var e,t;t=[];for(f=e=0;0<=r?e<r:e>r;f=0<=r?++e:--e){t.push([_.max([a[f][i-1],a[r][0]-a[f][0]]),f])}return t}(),function(e){return e[0]});a[r][i]=s[0];u[r-1][i-1]=s[1]}}o=o-1;t=t-2;n=[];while(t>=0){n=[function(){var n,i,s,a;a=[];for(r=n=i=u[o-1][t]+1,s=o+1;i<=s?n<s:n>s;r=i<=s?++n:--n){a.push(e[r])}return a}()].concat(n);o=u[o-1][t];t=t-1}return[function(){var t,n,i;i=[];for(r=t=0,n=o+1;0<=n?t<n:t>n;r=0<=n?++t:--t){i.push(e[r])}return i}()].concat(n)};var layoutPhotos=function(e,t,n,r){var i,s,o,u,a,f,l,c;var h=$(e);l=h.width();i=parseInt(h.height()/3);f=_.reduce(t,function(e,t){return e+=n(t)*i},0);a=Math.round(f/l);if(a<1){_.each(t,function(e){return r(e,parseInt(i*n(e)),i)})}else{c=_.map(t,function(e){return parseInt(n(e)*100)});o=linearPartition(c,a);s=0;_.each(o,function(e){var i;u=[];_.each(e,function(){var e=t[s++];u.push(e);return e});i=_.reduce(u,function(e,t){return e+=n(t)},0);return _.each(u,function(e){return r(e,parseInt(l/i*n(e)),parseInt(l/i))})})}h.empty();_.each(t,function(e){$(_.template('<img src="<%= photo_file_url %>" width="<%= width %>" height="<%= height %>"/>',e)).hide().appendTo(h).fadeIn("slow")})}